


# RECONSTRUCTION

## CIFAR10


```
# r_distort=0.2

!git pull
!git reset --hard origin/master
%run reconstruction.py \
-dataset=CIFAR10 \
-n_random_projections=512 \
-inv_lr=0.1 \
-inv_steps=100 \
-size_A=1024 \
-size_B=512 \
-batch_size=128 \
-f_reg=0 \
-f_crit=1 \
-f_stats=100 \
-r_distort_level=0.2 \
-r_block_width=16 \
-r_block_depth=4 \
--plot_ideal \
-show_after=20 \
-seed=1 \

# -size_A=-1 \
# -size_B=512 \
# -batch_size=256 \
# -seed=23456

# --reset_stats \
```


```
# pretty samples
# r_distort=0.1

!git pull
!git reset --hard origin/master
%run reconstruction.py \
-dataset=CIFAR10 \
-n_random_projections=512 \
-inv_lr=0.1 \
-inv_steps=100 \
-size_A=1024 \
-size_B=512 \
-batch_size=128 \
-f_reg=0 \
-f_crit=1 \
-f_stats=100 \
-r_distort_level=0.1 \
--plot_ideal \
-show_after=20 \
-seed=1
```


    Output hidden; open in https://colab.research.google.com to view.


## MNIST





```
!git pull
!git reset --hard origin/master
%run reconstruction.py \
-dataset=MNIST \
-n_random_projections=512 \
-inv_lr=0.1 \
-inv_steps=100 \
-size_A=-1 \
-size_B=512 \
-batch_size=128 \
-f_reg=0 \
-f_crit=1 \
-f_stats=0.001 \
-r_distort_level=0.5 \
--plot_ideal \
-show_after=20 \
```


    Output hidden; open in https://colab.research.google.com to view.



```
# deeper blocks
!git pull
!git reset --hard origin/master
%run reconstruction.py \
-dataset=MNIST \
-n_random_projections=512 \
-inv_lr=0.1 \
-inv_steps=100 \
-size_A=-1 \
-size_B=512 \
-batch_size=128 \
-f_reg=0 \
-f_crit=1 \
-f_stats=0.001 \
-r_distort_level=0.5 \
-r_block_depth=8 \
--plot_ideal \
-show_after=20 \
--reset_stats \
```

# INVERSION


## CIFAR10


```
# USING SCALE_EACH
!git pull
!git reset --hard origin/master
%run inversion.py \
-dataset=CIFAR10 \
-n_random_projections=512 \
-inv_lr=0.1 \
-inv_steps=700 \
-batch_size=256 \
-size_A=1024 \
-size_B=256 \
-f_reg=0.001 \
-f_crit=1 \
-f_stats=100 \
--use_jitter \
--plot_ideal \
--scale_each \

```

    Already up to date.
    HEAD is now at 8b1cf4e depth
    # Testing reconstruction methods
    # on CIFAR10
    Hyperparameters:
    dataset=CIFAR10
    seed=0
    nn_lr=0.01
    nn_steps=100
    batch_size=256
    n_random_projections=512
    inv_lr=0.1
    inv_steps=700
    f_reg=0.001
    f_crit=1.0
    f_stats=100.0
    size_A=1024
    size_B=256
    show_after=50
    nn_resume_train=False
    nn_reset_train=False
    use_amp=False
    use_std=False
    use_jitter=True
    plot_ideal=True
    scale_each=True 
    
    Running on 'cuda'
    
    Files already downloaded and verified
    Files already downloaded and verified
    Training Checkpoint restored: /content/drive/My Drive/Thesis/models/CIFAR10/net_resnet34.pt
    net accuracy: 96.5%
    Training Checkpoint restored: /content/drive/My Drive/Thesis/models/CIFAR10/net_resnet50.pt
    verifier net accuracy: 81.8%
    
    Loading data from /content/drive/My Drive/Thesis/models/CIFAR10/RP-512.
    Loading data from /content/drive/My Drive/Thesis/models/CIFAR10/stats_inputs.pt.
    Loading data from /content/drive/My Drive/Thesis/models/CIFAR10/stats_inputs-CC.pt.
    Loading data from /content/drive/My Drive/Thesis/models/CIFAR10/stats_RP-512.pt.
    Loading data from /content/drive/My Drive/Thesis/models/CIFAR10/stats_RP-CC-512.pt.
    Loading data from /content/drive/My Drive/Thesis/models/CIFAR10/stats_NN.pt.
    Loading data from /content/drive/My Drive/Thesis/models/CIFAR10/stats_NN-CC.pt.
    Loading data from /content/drive/My Drive/Thesis/models/CIFAR10/stats_NN-ALL.pt.
    Loading data from /content/drive/My Drive/Thesis/models/CIFAR10/stats_NN-ALL-CC.pt.
    Loading data from /content/drive/My Drive/Thesis/models/CIFAR10/stats_RP-512.pt.
    Loading data from /content/drive/My Drive/Thesis/models/CIFAR10/stats_RP-CC-512.pt.


    100%|██████████| 4/4 [00:00<00:00, 18.27batch/s]

    
    Saving data to /content/drive/My Drive/Thesis/models/CIFAR10/stats_RP-ReLU-512.pt.


    
    100%|██████████| 4/4 [00:00<00:00, 16.85batch/s]

    
    Saving data to /content/drive/My Drive/Thesis/models/CIFAR10/stats_RP-ReLU-CC-512.pt.
    Loading data from /content/drive/My Drive/Thesis/models/CIFAR10/stats_NN-ALL-+-RP-CC-512.pt.
    
    
    
    ## Method: CRITERION
    
    
    epoch 0:


    






    


      7%|▋         |50.0/700 [00:50<10:45,1.01epoch/s, accuracy=0.992, ideal=0.502, loss=0.568, |grad|=0.00687]

    
    epoch 50:






    


      9%|▉         |64.0/700 [01:04<10:30,1.01epoch/s, accuracy=1, ideal=0.502, loss=0.535, |grad|=0.00524]


```
# BASELINE, SANITY RUN

!git pull
!git reset --hard origin/master
%run ext/Nvlabs/cifar10/deepinversion-redo.py
```


    Output hidden; open in https://colab.research.google.com to view.



```
# REDO MEAN + SCALE EACH
!git pull
!git reset --hard origin/master
%run inversion.py \
-dataset=CIFAR10 \
-inv_lr=0.1 \
-inv_steps=700 \
-batch_size=256 \
-size_B=256 \
-f_reg=0.001 \
-f_crit=1 \
-f_stats=10 \
-n_random_projections=256 \
-show_after=100
--use_jitter \
--plot_ideal \
--scale_each \

```

    Already up to date.
    HEAD is now at d8ceb64 stats comparability
    # Testing reconstruction methods
    # on CIFAR10
    Hyperparameters:
    dataset=CIFAR10
    seed=0
    nn_resume_train=False
    nn_reset_train=False
    use_amp=False
    use_std=False
    use_jitter=False
    plot_ideal=False
    nn_lr=0.01
    nn_steps=100
    batch_size=256
    n_random_projections=256
    inv_lr=0.1
    inv_steps=700
    f_reg=0.001
    f_crit=1.0
    f_stats=10.0
    size_A=-1
    size_B=256
    show_after=100 
    
    Running on 'cuda'
    
    Files already downloaded and verified
    Files already downloaded and verified
    Training Checkpoint restored: /content/drive/My Drive/Thesis/models/CIFAR10/net_resnet34.pt
    net accuracy: 96.2%
    Training Checkpoint restored: /content/drive/My Drive/Thesis/models/CIFAR10/net_resnet50.pt
    verifier net accuracy: 80.6%
    
    Loading data from /content/drive/My Drive/Thesis/models/CIFAR10/RP-256.
    Loading data from /content/drive/My Drive/Thesis/models/CIFAR10/stats_inputs.pt.
    Loading data from /content/drive/My Drive/Thesis/models/CIFAR10/stats_inputs-CC.pt.
    Loading data from /content/drive/My Drive/Thesis/models/CIFAR10/stats_RP-256.pt.
    Loading data from /content/drive/My Drive/Thesis/models/CIFAR10/stats_RP-CC-256.pt.
    Loading data from /content/drive/My Drive/Thesis/models/CIFAR10/stats_NN.pt.
    Loading data from /content/drive/My Drive/Thesis/models/CIFAR10/stats_NN-CC.pt.
    Loading data from /content/drive/My Drive/Thesis/models/CIFAR10/stats_NN-ALL.pt.
    Loading data from /content/drive/My Drive/Thesis/models/CIFAR10/stats_NN-ALL-CC.pt.
    Loading data from /content/drive/My Drive/Thesis/models/CIFAR10/stats_RP-256.pt.
    Loading data from /content/drive/My Drive/Thesis/models/CIFAR10/stats_RP-CC-256.pt.
    Loading data from /content/drive/My Drive/Thesis/models/CIFAR10/stats_NN-ALL-+-RP-CC-256.pt.
    
    
    ## Method: CRITERION
    


     14%|█▍        |101.0/700 [02:48<16:39,1.67s/epoch, accuracy=1, loss=0.581, |grad|=0.00437]

    
    epoch 100:






    


     29%|██▊       |201.0/700 [05:35<13:52,1.67s/epoch, accuracy=1, loss=0.385, |grad|=0.00545]

    
    epoch 200:






    


     43%|████▎     |301.0/700 [08:22<11:06,1.67s/epoch, accuracy=1, loss=0.374, |grad|=0.0067] 

    
    epoch 300:






    


     57%|█████▋    |401.0/700 [11:09<08:18,1.67s/epoch, accuracy=1, loss=0.398, |grad|=0.00712]

    
    epoch 400:






    


     72%|███████▏  |501.0/700 [13:56<05:32,1.67s/epoch, accuracy=1, loss=0.376, |grad|=0.00629]

    
    epoch 500:






    


     86%|████████▌ |601.0/700 [16:43<02:45,1.67s/epoch, accuracy=1, loss=0.389, |grad|=0.00639]

    
    epoch 600:






    


    100%|██████████|700.0/700 [19:29<00:00,1.67s/epoch, accuracy=1, loss=0.378, |grad|=0.00628]

    


    










    Inverted:






    	nn accuracy: 100.0 %
    	nn verifier accuracy: 39.8 %
    
    
    ## Method: NN
    


     14%|█▍        |101.0/700 [02:48<16:42,1.67s/epoch, accuracy=1, loss=0.712, |grad|=0.00392]

    
    epoch 100:






    


     29%|██▊       |201.0/700 [05:36<13:54,1.67s/epoch, accuracy=1, loss=0.404, |grad|=0.00486]

    
    epoch 200:






    


     43%|████▎     |301.0/700 [08:23<11:07,1.67s/epoch, accuracy=1, loss=0.395, |grad|=0.00506]

    
    epoch 300:






    


     57%|█████▋    |401.0/700 [11:11<08:20,1.67s/epoch, accuracy=1, loss=0.389, |grad|=0.00523]

    
    epoch 400:






    


     72%|███████▏  |501.0/700 [13:58<05:32,1.67s/epoch, accuracy=1, loss=0.416, |grad|=0.00469]

    
    epoch 500:






    


     86%|████████▌ |601.0/700 [16:46<02:45,1.67s/epoch, accuracy=1, loss=0.392, |grad|=0.00559]

    
    epoch 600:






    


    100%|██████████|700.0/700 [19:32<00:00,1.67s/epoch, accuracy=1, loss=0.4, |grad|=0.0115]

    


    














    Inverted:






    	nn accuracy: 100.0 %
    	nn verifier accuracy: 41.0 %
    
    
    ## Method: NN CC
    


     14%|█▍        |101.0/700 [02:50<16:48,1.68s/epoch, accuracy=0.984, loss=1.17, |grad|=0.0916]

    
    epoch 100:






    


     29%|██▊       |201.0/700 [05:38<13:59,1.68s/epoch, accuracy=0.996, loss=1.11, |grad|=0.0611]

    
    epoch 200:






    


     43%|████▎     |301.0/700 [08:26<11:11,1.68s/epoch, accuracy=1, loss=0.953, |grad|=0.0137]

    
    epoch 300:






    


     57%|█████▋    |401.0/700 [11:15<08:22,1.68s/epoch, accuracy=0.996, loss=1.04, |grad|=0.042] 

    
    epoch 400:






    


     72%|███████▏  |501.0/700 [14:03<05:34,1.68s/epoch, accuracy=1, loss=1.05, |grad|=0.0128]

    
    epoch 500:






    


     86%|████████▌ |601.0/700 [16:51<02:46,1.68s/epoch, accuracy=1, loss=0.936, |grad|=0.0161] 

    
    epoch 600:






    


    100%|██████████|700.0/700 [19:38<00:00,1.68s/epoch, accuracy=0.996, loss=1.72, |grad|=0.016]

    


    














    Inverted:






    	nn accuracy: 100.0 %
    	nn verifier accuracy: 64.1 %
    
    
    ## Method: NN ALL
    


     14%|█▍        |101.0/700 [02:53<17:11,1.72s/epoch, accuracy=0.992, loss=9.26, |grad|=0.0911]

    
    epoch 100:






    


     29%|██▊       |201.0/700 [05:46<14:19,1.72s/epoch, accuracy=0.992, loss=5.52, |grad|=0.0787]

    
    epoch 200:






    


     43%|████▎     |301.0/700 [08:38<11:27,1.72s/epoch, accuracy=0.996, loss=3.65, |grad|=0.0894]

    
    epoch 300:






    


     57%|█████▋    |401.0/700 [11:31<08:34,1.72s/epoch, accuracy=0.996, loss=2.82, |grad|=0.0825]

    
    epoch 400:






    


     72%|███████▏  |501.0/700 [14:23<05:42,1.72s/epoch, accuracy=0.996, loss=2.63, |grad|=0.0848]

    
    epoch 500:






    


     86%|████████▌ |601.0/700 [17:16<02:50,1.73s/epoch, accuracy=0.996, loss=2.46, |grad|=0.0807]

    
    epoch 600:






    


    100%|██████████|700.0/700 [20:07<00:00,1.72s/epoch, accuracy=1, loss=2.84, |grad|=0.0759]

    


    


















    Inverted:






    	nn accuracy: 100.0 %
    	nn verifier accuracy: 75.4 %
    
    
    ## Method: NN ALL CC
    


     14%|█▍        |101.0/700 [03:29<20:44,2.08s/epoch, accuracy=1, loss=1.57, |grad|=0.00304]

    
    epoch 100:






    


     29%|██▊       |201.0/700 [06:58<17:19,2.08s/epoch, accuracy=1, loss=1.26, |grad|=0.00259]

    
    epoch 200:






    


     43%|████▎     |301.0/700 [10:26<13:51,2.08s/epoch, accuracy=1, loss=1.01, |grad|=0.00239]

    
    epoch 300:






    


     57%|█████▋    |401.0/700 [13:54<10:21,2.08s/epoch, accuracy=1, loss=0.753, |grad|=0.00262]

    
    epoch 400:






    


     72%|███████▏  |501.0/700 [17:22<06:53,2.08s/epoch, accuracy=1, loss=0.697, |grad|=0.00326]

    
    epoch 500:






    


     86%|████████▌ |601.0/700 [20:50<03:25,2.08s/epoch, accuracy=1, loss=0.669, |grad|=0.00443]

    
    epoch 600:






    


    100%|██████████|700.0/700 [24:15<00:00,2.08s/epoch, accuracy=1, loss=0.653, |grad|=0.00409]

    


    


















    Inverted:






    	nn accuracy: 100.0 %
    	nn verifier accuracy: 41.8 %
    
    
    ## Method: RP
    


     14%|█▍        |101.0/700 [02:49<16:42,1.67s/epoch, accuracy=1, loss=4.28, |grad|=0.104]

    
    epoch 100:






    


     29%|██▊       |201.0/700 [05:36<13:54,1.67s/epoch, accuracy=1, loss=2.91, |grad|=0.105]

    
    epoch 200:






    


     43%|████▎     |301.0/700 [08:24<11:07,1.67s/epoch, accuracy=1, loss=2.53, |grad|=0.104]

    
    epoch 300:






    


     57%|█████▋    |401.0/700 [11:11<08:20,1.67s/epoch, accuracy=1, loss=2.35, |grad|=0.104]

    
    epoch 400:






    


     72%|███████▏  |501.0/700 [13:59<05:32,1.67s/epoch, accuracy=1, loss=2.31, |grad|=0.104]

    
    epoch 500:






    


     86%|████████▌ |601.0/700 [16:46<02:45,1.67s/epoch, accuracy=1, loss=2.14, |grad|=0.104]

    
    epoch 600:






    


    100%|██████████|700.0/700 [19:32<00:00,1.68s/epoch, accuracy=1, loss=2.19, |grad|=0.104]

    


    














    Inverted:






    	nn accuracy: 100.0 %
    	nn verifier accuracy: 35.2 %
    
    
    ## Method: RP CC
    


     14%|█▍        |101.0/700 [02:50<16:52,1.69s/epoch, accuracy=0.801, loss=13.2, |grad|=2.12]

    
    epoch 100:






    


     29%|██▊       |201.0/700 [05:39<14:03,1.69s/epoch, accuracy=0.891, loss=13.4, |grad|=2.13]

    
    epoch 200:






    


     43%|████▎     |301.0/700 [08:29<11:14,1.69s/epoch, accuracy=0.934, loss=12.3, |grad|=2.04]

    
    epoch 300:






    


     57%|█████▋    |401.0/700 [11:18<08:28,1.70s/epoch, accuracy=0.961, loss=13.2, |grad|=2.06]

    
    epoch 400:






    


     72%|███████▏  |501.0/700 [14:07<05:36,1.69s/epoch, accuracy=0.973, loss=11.2, |grad|=2]   

    
    epoch 500:






    


     86%|████████▌ |601.0/700 [16:56<02:47,1.69s/epoch, accuracy=0.984, loss=10.3, |grad|=1.9] 

    
    epoch 600:






    


     89%|████████▉ |625.0/700 [17:37<02:06,1.69s/epoch, accuracy=0.988, loss=9.98, |grad|=2.06]


## MNIST


```
!git pull
!git reset --hard origin/master
%run inversion.py \
-dataset=MNIST \
-n_random_projections=512 \
-nn_steps=1 \
-size_A=-1 \
-size_B=128 \
-batch_size=128 \
-inv_lr=0.05 \
-inv_steps=500 \
-f_reg=0.0005 \
-f_crit=1 \
-f_stats=0.001 \
-show_after=100 \
-seed=-1 \
--use_jitter \
--plot_ideal \

# --nn_resume_train \
# --reset_stats \

```


    Output hidden; open in https://colab.research.google.com to view.



# GMMs



```
# !git pull
# !git reset --hard origin/master
%run projectOK/main.py \
-dataset=GMM \
-distort_level=1.0 \
-batch_size=-1 \
-nn_lr=0.01 \
-nn_steps=500 \
-n_random_projections=256 \
-inv_lr=0.1 \
-inv_steps=1000 \
-g_modes=12 \
-g_scale_mean=3 \
-g_scale_cov=20 \
-g_mean_shift=2.5 \
--nn_reset_train \
--use_drive \

# %run projectOK/mainGMM.py \
# -seed=300 \
# -n_classes=10 \
# -n_dims=20 \
# -n_samples_A=5000 \
# -n_samples_B=1000 \
# -n_samples_valid=5000 \
# -distort_level=1.0 \
# -g_modes=12 \
# -g_scale_mean=3 \
# -g_scale_cov=20 \
# -g_mean_shift=2.5 \
# -nn_lr=0.01 \
# -nn_steps=500 \
# -nn_width=32 \
# -nn_depth=4 \
# -n_random_projections=128 \
# -inv_lr=0.1 \
# -inv_steps=1000 \
# --nn_verifier \

```

    # Testing reconstruction methods
    # on GMM
    Hyperparameters:
    dataset=GMM
    seed=0
    nn_resume_train=False
    nn_reset_train=True
    use_amp=False
    use_drive=True
    use_var=False
    perturb_strength=1.0
    nn_lr=0.01
    nn_steps=500
    batch_size=-1
    n_random_projections=256
    inv_lr=0.1
    inv_steps=1000
    g_modes=12
    g_scale_mean=3.0
    g_scale_cov=20.0
    g_mean_shift=2.5
    
    Running on 'cuda'
    No Checkpoint found / Reset.
    Path: /content/drive/My Drive/Thesis/models/GMM/net_GMM_20-32-32-32-32-3
    Beginning training.


    /usr/local/lib/python3.6/dist-packages/scipy/stats/_multivariate.py:660: RuntimeWarning: covariance is not positive-semidefinite.
      out = random_state.multivariate_normal(mean, cov, size)



    HBox(children=(FloatProgress(value=0.0, max=500.0), HTML(value='')))


    






    No Checkpoint found / Reset.
    Path: /content/drive/My Drive/Thesis/models/GMM/net_GMM_20-32-32-32-32-3_verifier
    Beginning training.



    HBox(children=(FloatProgress(value=0.0, max=500.0), HTML(value='')))


    
    Loading stats from /content/drive/My Drive/Thesis/models/GMM/stats_inputs.pt.
    Loading stats from /content/drive/My Drive/Thesis/models/GMM/stats_inputs-CC.pt.
    Beginning tracking stats.



    HBox(children=(FloatProgress(value=0.0, max=1.0), HTML(value='')))


    
    Saving stats in /content/Thesis/models/GMM/stats_NN.pt.
    
    Beginning tracking stats.



    HBox(children=(FloatProgress(value=0.0, max=1.0), HTML(value='')))


    
    Saving stats in /content/Thesis/models/GMM/stats_NN-CC.pt.
    
    Beginning tracking stats.



    HBox(children=(FloatProgress(value=0.0, max=1.0), HTML(value='')))


    
    Saving stats in /content/Thesis/models/GMM/stats_NN-ALL.pt.
    
    Beginning tracking stats.



    HBox(children=(FloatProgress(value=0.0, max=1.0), HTML(value='')))


    
    Saving stats in /content/Thesis/models/GMM/stats_NN-ALL-CC.pt.
    
    Beginning tracking stats.



    HBox(children=(FloatProgress(value=0.0, max=1.0), HTML(value='')))


    
    Saving stats in /content/Thesis/models/GMM/stats_RP.pt.
    
    Beginning tracking stats.



    HBox(children=(FloatProgress(value=0.0, max=1.0), HTML(value='')))


    
    Saving stats in /content/Thesis/models/GMM/stats_RP-CC.pt.
    
    Beginning tracking stats.



    HBox(children=(FloatProgress(value=0.0, max=1.0), HTML(value='')))


    
    Saving stats in /content/Thesis/models/GMM/stats_RP-ReLU.pt.
    
    Beginning tracking stats.



    HBox(children=(FloatProgress(value=0.0, max=1.0), HTML(value='')))


    
    Saving stats in /content/Thesis/models/GMM/stats_RP-ReLU-CC.pt.
    
    Beginning tracking stats.



    HBox(children=(FloatProgress(value=0.0, max=1.0), HTML(value='')))


    
    Saving stats in /content/Thesis/models/GMM/stats_combined.pt.
    
    
    ## Method: NN
    Beginning Inversion.



    HBox(children=(FloatProgress(value=0.0, max=1000.0), HTML(value='')))


    






    Results:
    	loss: 0.000
    	rel. l2 reconstruction error: 7.924
    	nn accuracy: 37.4 %
    	nn validation set accuracy: 40.4 %
    	nn verifier accuracy: 29.3 %
    
    ## Method: NN-CC
    Beginning Inversion.



    HBox(children=(FloatProgress(value=0.0, max=1000.0), HTML(value='')))


    






    Results:
    	loss: 0.019
    	rel. l2 reconstruction error: 8.403
    	nn accuracy: 98.0 %
    	nn validation set accuracy: 68.7 %
    	nn verifier accuracy: 49.5 %
    
    ## Method: NN-ALL
    Beginning Inversion.



    HBox(children=(FloatProgress(value=0.0, max=1000.0), HTML(value='')))


    






    Results:
    	loss: 0.002
    	rel. l2 reconstruction error: 2.717
    	nn accuracy: 32.3 %
    	nn validation set accuracy: 44.4 %
    	nn verifier accuracy: 33.3 %
    
    ## Method: NN-ALL-CC
    Beginning Inversion.



    HBox(children=(FloatProgress(value=0.0, max=1000.0), HTML(value='')))


    






    Results:
    	loss: 0.067
    	rel. l2 reconstruction error: 6.580
    	nn accuracy: 98.0 %
    	nn validation set accuracy: 80.8 %
    	nn verifier accuracy: 86.9 %
    
    ## Method: RP
    Beginning Inversion.



    HBox(children=(FloatProgress(value=0.0, max=1000.0), HTML(value='')))


    






    Results:
    	loss: 0.059
    	rel. l2 reconstruction error: 3.718
    	nn accuracy: 24.2 %
    	nn validation set accuracy: 28.3 %
    	nn verifier accuracy: 22.2 %
    
    ## Method: RP-CC
    Beginning Inversion.



    HBox(children=(FloatProgress(value=0.0, max=1000.0), HTML(value='')))


    






    Results:
    	loss: 0.109
    	rel. l2 reconstruction error: 5.292
    	nn accuracy: 82.8 %
    	nn validation set accuracy: 70.7 %
    	nn verifier accuracy: 82.8 %
    
    ## Method: RP-ReLU
    Beginning Inversion.



    HBox(children=(FloatProgress(value=0.0, max=1000.0), HTML(value='')))


    






    Results:
    	loss: 0.010
    	rel. l2 reconstruction error: 3.106
    	nn accuracy: 37.4 %
    	nn validation set accuracy: 32.3 %
    	nn verifier accuracy: 38.4 %
    
    ## Method: RP-ReLU-CC
    Beginning Inversion.



    HBox(children=(FloatProgress(value=0.0, max=1000.0), HTML(value='')))


    






    Results:
    	loss: 0.062
    	rel. l2 reconstruction error: 5.377
    	nn accuracy: 80.8 %
    	nn validation set accuracy: 74.7 %
    	nn verifier accuracy: 79.8 %
    
    ## Method: combined
    Beginning Inversion.



    HBox(children=(FloatProgress(value=0.0, max=1000.0), HTML(value='')))


    






    Results:
    	loss: 0.142
    	rel. l2 reconstruction error: 6.774
    	nn accuracy: 98.0 %
    	nn validation set accuracy: 85.9 %
    	nn verifier accuracy: 90.9 %
    
    # Summary
    =========
    
    
    baseline       acc   acc(val)  acc(ver)  
    -----------------------------------------
    B (original)   0.97  0.93      0.97      
    B (perturbed)  0.39  0.34      0.39      
    A              1.00  N.A.      1.00      
    
    Reconstruction methods:
    
    method      acc   acc(val)  acc(ver)  l2-err  loss  
    ----------------------------------------------------
    NN          0.37  0.40      0.29      7.92    0.00  
    NN-CC       0.98  0.69      0.49      8.40    0.02  
    NN-ALL      0.32  0.44      0.33      2.72    0.00  
    NN-ALL-CC   0.98  0.81      0.87      6.58    0.07  
    RP          0.24  0.28      0.22      3.72    0.06  
    RP-CC       0.83  0.71      0.83      5.29    0.11  
    RP-ReLU     0.37  0.32      0.38      3.11    0.01  
    RP-ReLU-CC  0.81  0.75      0.80      5.38    0.06  
    combined    0.98  0.86      0.91      6.77    0.14  



```
baseline       acc   acc(val)  c-entr  acc(ver)  
-------------------------------------------------
B (original)   0.91  0.92      54.99   0.91      
B (perturbed)  0.17  0.16      inf     0.16      
A              0.94  N.A.      54.99   0.94      

Reconstruction methods:

method      acc   acc(val)  acc(ver)  l2-err  loss  c-entr  
------------------------------------------------------------
NN          0.14  0.14      0.14      8.67    0.00  inf     
NN CC       0.89  0.88      0.87      5.46    0.14  inf     
NN ALL      0.14  0.14      0.13      3.12    0.00  inf     
NN ALL CC   0.90  0.90      0.89      0.93    0.04  58.37   
RP          0.11  0.10      0.10      2.90    0.00  inf     
RP CC       0.89  0.89      0.89      1.30    0.04  58.86   
RP ReLU     0.10  0.10      0.11      4.40    0.00  inf     
RP ReLU CC  0.90  0.89      0.89      1.13    0.02  inf     
combined    0.90  0.90      0.90      0.71    0.03  inf     
```



# TESTS

## Test 1


```
%run projectOK/test1.py
```

    Simple regression test for recovering an affine transformation..
    






    Beginning Inversion.



    HBox(children=(FloatProgress(value=0.0, description='Step', max=200.0, style=ProgressStyle(description_width='…


    






    After Pre-Processing:






    l2 reconstruction error: 0.886


## Test 2


```
%run projectOK/test2.py
```

    ERROR:root:File `'projectOK/test2.py'` not found.


## Test 3


```
%run projectOK/test3.py
```

    Testing reconstruction by matching statistics
    of Gaussian Mixture Model on random projections..
    
    Before:
    Cross Entropy of A: 3.711257219314575
    Cross Entropy of B: 1088.7333984375


    /usr/local/lib/python3.6/dist-packages/scipy/stats/_multivariate.py:660: RuntimeWarning: covariance is not positive-semidefinite.
      out = random_state.multivariate_normal(mean, cov, size)










    Beginning Inversion.



    HBox(children=(FloatProgress(value=0.0, description='Step', max=400.0, style=ProgressStyle(description_width='…


    






    After Pre-Processing:
    Cross Entropy of B: 4.431112289428711
    Cross Entropy of unperturbed B: 3.6967499256134033






    l2 reconstruction error: 7.680



```
%run projectOK/test3bigger.py
```

    Test3 using random projections
    on 2 distinct clusters
    Comment:
    Method struggles with more seperated clusters
    


    /usr/local/lib/python3.6/dist-packages/scipy/stats/_multivariate.py:660: RuntimeWarning: covariance is not positive-semidefinite.
      out = random_state.multivariate_normal(mean, cov, size)










    Before:
    Cross Entropy of A: 5.0765461921691895
    Cross Entropy of B: inf
    Beginning Inversion.



    HBox(children=(FloatProgress(value=0.0, description='Step', max=600.0, style=ProgressStyle(description_width='…


    






    After Pre-Processing:
    Cross Entropy of B: inf
    Cross Entropy of unperturbed B: 4.961302757263184














    l2 reconstruction error: 35.574


## Test 4


```
%run projectOK/test4.py
```

    Testing reconstruction by matching
    class-conditional statistics
    


    /usr/local/lib/python3.6/dist-packages/scipy/stats/_multivariate.py:660: RuntimeWarning: covariance is not positive-semidefinite.
      out = random_state.multivariate_normal(mean, cov, size)






    Before:
    Cross Entropy of A: 5.0765461921691895
    Cross Entropy of B: inf
    Beginning Inversion.



    HBox(children=(FloatProgress(value=0.0, description='Step', style=ProgressStyle(description_width='initial')),…


    






    After Pre-Processing:
    Cross Entropy of B: 6.816658973693848
    Cross Entropy of unperturbed B: 4.961302757263184






    l2 reconstruction error: 1.083


## Test 5


```
%run projectOK/test5.py
```

    Testing reconstruction by matching
    class-conditional statistics on random projections
    


    /usr/local/lib/python3.6/dist-packages/scipy/stats/_multivariate.py:660: RuntimeWarning: covariance is not positive-semidefinite.
      out = random_state.multivariate_normal(mean, cov, size)










    Before:
    Cross Entropy of A: 5.0765461921691895
    Cross Entropy of B: inf
    Beginning Inversion.



    HBox(children=(FloatProgress(value=0.0, description='Step', max=400.0, style=ProgressStyle(description_width='…


    






    After Pre-Processing:
    Cross Entropy of B: 6.226280689239502
    Cross Entropy of unperturbed B: 4.961302757263184






    l2 reconstruction error: 1.945


## Test 6


```
%run projectOK/test6.py
```

    Testing reconstruction by matching
    statistics on neural network feature
    
    Training Checkpoint restored: /content/Thesis/models/net_GMM_2-16-16-16-3.pt


    /usr/local/lib/python3.6/dist-packages/scipy/stats/_multivariate.py:660: RuntimeWarning: covariance is not positive-semidefinite.
      out = random_state.multivariate_normal(mean, cov, size)






    Before:
    Cross Entropy of A: 5.5779805183410645
    Cross Entropy of B: inf
    Beginning Inversion.



    HBox(children=(FloatProgress(value=0.0, description='Step', max=400.0, style=ProgressStyle(description_width='…


    






    After Pre-Processing:
    Cross Entropy of B: 6.1775803565979





